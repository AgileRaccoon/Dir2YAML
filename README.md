# Dir2YAML

複数のディレクトリを再帰的に走査し、  
**ファイル・フォルダ構造をYAML出力する**アプリケーションです。

Tkinter を使用したGUIを備えており、  
- **ディレクトリ追加・削除**  
- **Ignore Patterns**（除外パターン）の登録  
- **プロジェクト名**の設定（任意）  
- **YAML生成**（相対パス構造）  
- **コピー / 保存**（生成結果）  
などを、ひとつの画面から行うことができます。

## 目次
- [Dir2YAML](#dir2yaml)
  - [目次](#目次)
  - [特徴](#特徴)
  - [セットアップ](#セットアップ)
  - [使い方](#使い方)
  - [設定ファイル (`config.json`) について](#設定ファイル-configjson-について)
  - [更新履歴](#更新履歴)
    - [追加と更新 (v0.7.2 - stable)](#追加と更新-v072---stable)
    - [軽微な更新 (v0.7.1 - stable)](#軽微な更新-v071---stable)
    - [公開 (v0.7.0 - stable)](#公開-v070---stable)

---

## 特徴

1. **相対パス構造**  
   - 指定ディレクトリを「ルート」とし、その下のファイル・サブフォルダを相対パスで表現。  
   - 上位ディレクトリは含めません。

2. **複数ディレクトリ対応**  
   - 複数のルートディレクトリを並列して登録可能。  
   - 同じディレクトリやそのサブフォルダ／上位フォルダの重複登録は不可。

3. **Ignore Patterns**  
   - `.env`, `.htpasswd`, `*.log` などのデフォルトパターンを編集不可で保持し、  
   - ユーザパターンを自由に追加（例: `*.tmp, *.bak`）。  
   - 「登録」ボタンで都度反映できます。

4. **プロジェクト名**  
   - GUI上で自由に入力できます。未入力の場合は、指定ディレクトリ名を連結した名前を自動生成。

5. **大型ファイル / バイナリファイルの扱い**  
   - `max_file_size_bytes` を指定すると、それを超えるファイルの内容は `[SKIPPED due to size]` として読み込みを抑制。  
   - バイナリらしきファイル(`\0` を含むなど)も `[SKIPPED or BINARY]` としてスキップ。

6. **GUI操作**  
   - **YAML生成**ボタンを押すと別スレッドでディレクトリ走査を行い、GUIがフリーズしにくい。  
   - 進捗ログを随時テキストエリアに表示。  
   - 生成したYAMLはその場でコピーまたは保存可能。  
   - 「クリア」ボタンで生成済みYAMLをリリースし、再度「コピー・保存」が無効化されます。

---

## セットアップ

1. **このリポジトリをクローンまたはダウンロード**  

2. **ライブラリのインストール**  
   ```bash
   pip install pyyaml pyperclip
   ```
   - tkinter は標準ライブラリですが、Mac環境では標準Pythonに含まれていない場合があります。
   - その場合は、Homebrewなどを用いて brew install python-tk などを実行し、tkinterを別途インストールしてください。

3. **アプリケーションの起動**  
   ```bash
   python main.py
   ```
   - GUIが立ち上がり、操作可能になります。

---

## 使い方

1. **ディレクトリ追加**  
   - 「ディレクトリ追加」ボタンをクリックし、フォルダを選択。  
   - 重複やサブディレクトリ／上位フォルダにあたる場合は登録できません。

2. **Ignore Patterns**  
   - 既定のパターン (`.env, .htpasswd, *.log`) は編集不可で表示。  
   - 追加したい除外パターンをテキストボックスに入力し、「登録」ボタンを押すと反映されます。

3. **プロジェクト名 (任意)**  
   - 「プロジェクト名:」欄に文字を入力するか、そのまま空欄でOKです。  
   - 空欄の場合はディレクトリ名を連結したものが自動的にプロジェクト名になります。

4. **YAML生成**  
   - 「YAML生成」ボタンをクリックすると、別スレッドで走査が始まり、下部の「Progress Log」に進捗が表示されます。  
   - 生成が終わると「コピー」「保存」ボタンが有効になります。

5. **クリア**  
   - 「クリア」ボタンを押すと、生成済みYAMLを破棄し、再びコピー・保存が無効になります。  
   - 進捗ログはそのまま残ります（消したい場合はコード内コメントを外してご利用ください）。

6. **コピー / 保存**  
   - 「コピー」ボタンでYAMLテキストをクリップボードにコピー。  
   - 「保存」ボタンでファイルダイアログが開き、`.yml` ファイルとして保存可能。

---

## 設定ファイル (`config.json`) について

- アプリを起動すると同階層に `config.json` が作成され、ユーザが最後に指定したディレクトリや除外パターン等が保存されます。
- 例:
  ```json
  {
    "directories": [
      "C:/path/to/mydir"
    ],
    "ignore_patterns": [
      "*.tmp",
      "*.bak"
    ],
    "max_file_size_bytes": 500000
  }
  ```
- `max_file_size_bytes` でファイル内容の読み込み上限をバイト単位で指定。

---

## 更新履歴
### 追加と更新 (v0.7.2 - stable)
- Readmeの更新
- ウインドウサイズを修正
- exeファイルの実装を一時中止

### 軽微な更新 (v0.7.1 - stable)
- Macなどダークテーマ環境で白文字設定のモジュールが読めない問題を修正
- 最大読み込みファイルサイズが50,000byteでは少なすぎるため500,000byteに修正

### 公開 (v0.7.0 - stable)
- ディレクトリやサブディレクトリの重複登録を禁止
- Ignore Patterns を「デフォルト(編集不可) + ユーザ追加(登録ボタン)」の形式に整理
- プロジェクト名のテキストボックスをGUIに追加  
  - 未入力時はディレクトリ名を自動連結
- 進捗ログを Tkinter ScrolledText で表示、GUIフリーズを防ぐため別スレッド実行
- YAML生成後に「コピー / 保存」ボタンを有効化、クリアボタンで再び無効化  
  - ボタンが無効時は背景色を暗くし、状態をわかりやすく改善
- 大型ファイル / バイナリファイルの内容スキップに対応  
- 相対パス構造でYAMLを出力し、上位ディレクトリは含まない